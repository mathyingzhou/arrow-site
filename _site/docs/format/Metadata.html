


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Metadata: Logical types, schemas, data headers &mdash; Apache Arrow v0.13.0</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Interprocess messaging / communication (IPC)" href="IPC.html" />
    <link rel="prev" title="Physical memory layout" href="Layout.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Apache Arrow
          

          
          </a>

          
            
            
              <div class="version">
                0.13.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Arrow Columnar Format</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Arrow specification documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="Guidelines.html">Implementation guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Layout.html">Physical memory layout</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Metadata: Logical types, schemas, data headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#canonical-implementation">Canonical implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#schemas">Schemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#record-data-headers">Record data headers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#buffers">Buffers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#field-metadata">Field metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#flattening-of-nested-data">Flattening of nested data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logical-types">Logical types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#integers">Integers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#floating-point-numbers">Floating point numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boolean">Boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utf8-and-binary">Utf8 and Binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decimal">Decimal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timestamp">Timestamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#date">Date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time">Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dictionary-encoding">Dictionary encoding</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="IPC.html">Interprocess messaging / communication (IPC)</a></li>
</ul>
<p class="caption"><span class="caption-text">Arrow Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cpp/index.html">C++ Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">Python bindings</a></li>
</ul>
<p class="caption"><span class="caption-text">Development and Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developers/contributing.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/cpp.html">C++ Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/python.html">Python Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/integration.html">Integration Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/documentation.html">Building the Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Apache Arrow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Metadata: Logical types, schemas, data headers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/format/Metadata.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metadata-logical-types-schemas-data-headers">
<h1>Metadata: Logical types, schemas, data headers<a class="headerlink" href="#metadata-logical-types-schemas-data-headers" title="Permalink to this headline">¶</a></h1>
<p>This is documentation for the Arrow metadata specification, which enables
systems to communicate the</p>
<ul class="simple">
<li>Logical array types (which are implemented using the physical memory layouts
specified in <a class="reference internal" href="Layout.html"><span class="doc">Physical memory layout</span></a>)</li>
<li>Schemas for table-like collections of Arrow data structures</li>
<li>“Data headers” indicating the physical locations of memory buffers sufficient
to reconstruct a Arrow data structures without copying memory.</li>
</ul>
<div class="section" id="canonical-implementation">
<h2>Canonical implementation<a class="headerlink" href="#canonical-implementation" title="Permalink to this headline">¶</a></h2>
<p>We are using <a class="reference external" href="http://github.com/google/flatbuffers">Flatbuffers</a> for low-overhead reading and writing of the Arrow
metadata. See <code class="docutils literal notranslate"><span class="pre">Message.fbs</span></code>.</p>
</div>
<div class="section" id="schemas">
<h2>Schemas<a class="headerlink" href="#schemas" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Schema</span></code> type describes a table-like structure consisting of any number of
Arrow arrays, each of which can be interpreted as a column in the table. A
schema by itself does not describe the physical structure of any particular set
of data.</p>
<p>A schema consists of a sequence of <strong>fields</strong>, which are metadata describing
the columns. The Flatbuffers IDL for a field is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="n">Field</span> <span class="p">{</span>
  <span class="o">//</span> <span class="n">Name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">required</span><span class="p">,</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">a</span> <span class="n">List</span>
  <span class="n">name</span><span class="p">:</span> <span class="n">string</span><span class="p">;</span>
  <span class="n">nullable</span><span class="p">:</span> <span class="nb">bool</span><span class="p">;</span>
  <span class="nb">type</span><span class="p">:</span> <span class="n">Type</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">Present</span> <span class="n">only</span> <span class="k">if</span> <span class="n">the</span> <span class="n">field</span> <span class="ow">is</span> <span class="n">dictionary</span> <span class="n">encoded</span>
  <span class="n">dictionary</span><span class="p">:</span> <span class="n">DictionaryEncoding</span><span class="p">;</span>

  <span class="o">//</span> <span class="n">children</span> <span class="n">apply</span> <span class="n">only</span> <span class="n">to</span> <span class="n">Nested</span> <span class="n">data</span> <span class="n">types</span> <span class="n">like</span> <span class="n">Struct</span><span class="p">,</span> <span class="n">List</span> <span class="ow">and</span> <span class="n">Union</span>
  <span class="n">children</span><span class="p">:</span> <span class="p">[</span><span class="n">Field</span><span class="p">];</span>

  <span class="o">//</span> <span class="n">User</span><span class="o">-</span><span class="n">defined</span> <span class="n">metadata</span>
  <span class="n">custom_metadata</span><span class="p">:</span> <span class="p">[</span> <span class="n">KeyValue</span> <span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> is the logical type of the field. Nested types, such as List,
Struct, and Union, have a sequence of child fields.</p>
<p>A JSON representation of the schema is also provided:</p>
<p>Field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;name_of_the_field&quot;</span><span class="p">,</span>
  <span class="s2">&quot;nullable&quot;</span> <span class="p">:</span> <span class="n">false</span><span class="p">,</span>
  <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="o">/*</span> <span class="n">Type</span> <span class="o">*/</span><span class="p">,</span>
  <span class="s2">&quot;children&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="o">/*</span> <span class="n">Field</span> <span class="o">*/</span> <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;null|struct|list|union|int|floatingpoint|utf8|binary|fixedsizebinary|bool|decimal|date|time|timestamp|interval&quot;</span>
  <span class="o">//</span> <span class="n">fields</span> <span class="k">as</span> <span class="n">defined</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">Flatbuffer</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">the</span> <span class="nb">type</span> <span class="n">name</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Union:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;union&quot;</span><span class="p">,</span>
  <span class="s2">&quot;mode&quot;</span> <span class="p">:</span> <span class="s2">&quot;Sparse|Dense&quot;</span><span class="p">,</span>
  <span class="s2">&quot;typeIds&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="o">/*</span> <span class="n">integer</span> <span class="o">*/</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">typeIds</span></code> field in the Union are the codes used to denote each type, which
may be different from the index of the child array. This is so that the union
type ids do not have to be enumerated from 0.</p>
<p>Int:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
  <span class="s2">&quot;bitWidth&quot;</span> <span class="p">:</span> <span class="o">/*</span> <span class="n">integer</span> <span class="o">*/</span><span class="p">,</span>
  <span class="s2">&quot;isSigned&quot;</span> <span class="p">:</span> <span class="o">/*</span> <span class="n">boolean</span> <span class="o">*/</span>
<span class="p">}</span>
</pre></div>
</div>
<p>FloatingPoint:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;floatingpoint&quot;</span><span class="p">,</span>
  <span class="s2">&quot;precision&quot;</span> <span class="p">:</span> <span class="s2">&quot;HALF|SINGLE|DOUBLE&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Decimal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;decimal&quot;</span><span class="p">,</span>
  <span class="s2">&quot;precision&quot;</span> <span class="p">:</span> <span class="o">/*</span> <span class="n">integer</span> <span class="o">*/</span><span class="p">,</span>
  <span class="s2">&quot;scale&quot;</span> <span class="p">:</span> <span class="o">/*</span> <span class="n">integer</span> <span class="o">*/</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Timestamp:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
  <span class="s2">&quot;unit&quot;</span> <span class="p">:</span> <span class="s2">&quot;SECOND|MILLISECOND|MICROSECOND|NANOSECOND&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Date:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span>
  <span class="s2">&quot;unit&quot;</span> <span class="p">:</span> <span class="s2">&quot;DAY|MILLISECOND&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span>
  <span class="s2">&quot;unit&quot;</span> <span class="p">:</span> <span class="s2">&quot;SECOND|MILLISECOND|MICROSECOND|NANOSECOND&quot;</span><span class="p">,</span>
  <span class="s2">&quot;bitWidth&quot;</span><span class="p">:</span> <span class="o">/*</span> <span class="n">integer</span><span class="p">:</span> <span class="mi">32</span> <span class="ow">or</span> <span class="mi">64</span> <span class="o">*/</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Interval:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;interval&quot;</span><span class="p">,</span>
  <span class="s2">&quot;unit&quot;</span> <span class="p">:</span> <span class="s2">&quot;YEAR_MONTH|DAY_TIME&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;fields&quot;</span> <span class="p">:</span> <span class="p">[</span>
    <span class="o">/*</span> <span class="n">Field</span> <span class="o">*/</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="record-data-headers">
<h2>Record data headers<a class="headerlink" href="#record-data-headers" title="Permalink to this headline">¶</a></h2>
<p>A record batch is a collection of top-level named, equal length Arrow arrays
(or vectors). If one of the arrays contains nested data, its child arrays are
not required to be the same length as the top-level arrays.</p>
<p>One can be thought of as a realization of a particular schema. The metadata
describing a particular record batch is called a “data header”. Here is the
Flatbuffers IDL for a record batch data header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="n">RecordBatch</span> <span class="p">{</span>
  <span class="n">length</span><span class="p">:</span> <span class="n">long</span><span class="p">;</span>
  <span class="n">nodes</span><span class="p">:</span> <span class="p">[</span><span class="n">FieldNode</span><span class="p">];</span>
  <span class="n">buffers</span><span class="p">:</span> <span class="p">[</span><span class="n">Buffer</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">RecordBatch</span></code> metadata provides for record batches with length exceeding
2 <sup>31</sup> - 1, but Arrow implementations are not required to implement support
beyond this size.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">nodes</span></code> and <code class="docutils literal notranslate"><span class="pre">buffers</span></code> fields are produced by a depth-first traversal /
flattening of a schema (possibly containing nested types) for a given in-memory
data set.</p>
<div class="section" id="buffers">
<h3>Buffers<a class="headerlink" href="#buffers" title="Permalink to this headline">¶</a></h3>
<p>A buffer is metadata describing a contiguous memory region relative to some
virtual address space. This may include:</p>
<ul class="simple">
<li>Shared memory, e.g. a memory-mapped file</li>
<li>An RPC message received in-memory</li>
<li>Data in a file</li>
</ul>
<p>The key form of the Buffer type is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">Buffer</span> <span class="p">{</span>
  <span class="n">offset</span><span class="p">:</span> <span class="n">long</span><span class="p">;</span>
  <span class="n">length</span><span class="p">:</span> <span class="n">long</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the context of a record batch, each field has some number of buffers
associated with it, which are derived from their physical memory layout.</p>
<p>Each logical type (separate from its children, if it is a nested type) has a
deterministic number of buffers associated with it. These will be specified in
the logical types section.</p>
</div>
<div class="section" id="field-metadata">
<h3>Field metadata<a class="headerlink" href="#field-metadata" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">FieldNode</span></code> values contain metadata about each level in a nested type
hierarchy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">FieldNode</span> <span class="p">{</span>
  <span class="o">///</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">value</span> <span class="n">slots</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">Arrow</span> <span class="n">array</span> <span class="n">at</span> <span class="n">this</span> <span class="n">level</span> <span class="n">of</span> <span class="n">a</span> <span class="n">nested</span>
  <span class="o">///</span> <span class="n">tree</span>
  <span class="n">length</span><span class="p">:</span> <span class="n">long</span><span class="p">;</span>

  <span class="o">///</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">observed</span> <span class="n">nulls</span><span class="o">.</span>
  <span class="n">null_count</span><span class="p">:</span> <span class="n">lohng</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">FieldNode</span></code> metadata provides for fields with length exceeding 2 <sup>31</sup> - 1,
but Arrow implementations are not required to implement support for large
arrays.</p>
</div>
</div>
<div class="section" id="flattening-of-nested-data">
<h2>Flattening of nested data<a class="headerlink" href="#flattening-of-nested-data" title="Permalink to this headline">¶</a></h2>
<p>Nested types are flattened in the record batch in depth-first order. When
visiting each field in the nested type tree, the metadata is appended to the
top-level <code class="docutils literal notranslate"><span class="pre">fields</span></code> array and the buffers associated with that field (but not
its children) are appended to the <code class="docutils literal notranslate"><span class="pre">buffers</span></code> array.</p>
<p>For example, let’s consider the schema</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">col1</span><span class="p">:</span> <span class="n">Struct</span><span class="o">&lt;</span><span class="n">a</span><span class="p">:</span> <span class="n">Int32</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Int64</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">Float64</span><span class="o">&gt;</span>
<span class="n">col2</span><span class="p">:</span> <span class="n">Utf8</span>
</pre></div>
</div>
<p>The flattened version of this is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FieldNode</span> <span class="mi">0</span><span class="p">:</span> <span class="n">Struct</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;col1&#39;</span>
<span class="n">FieldNode</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Int32</span> <span class="n">name</span><span class="o">=</span><span class="n">a</span><span class="s1">&#39;</span>
<span class="n">FieldNode</span> <span class="mi">2</span><span class="p">:</span> <span class="n">List</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
<span class="n">FieldNode</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Int64</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;item&#39;</span>  <span class="c1"># arbitrary</span>
<span class="n">FieldNode</span> <span class="mi">4</span><span class="p">:</span> <span class="n">Float64</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span>
<span class="n">FieldNode</span> <span class="mi">5</span><span class="p">:</span> <span class="n">Utf8</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;col2&#39;</span>
</pre></div>
</div>
<p>For the buffers produced, we would have the following (as described in more
detail for each type below):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">buffer</span> <span class="mi">0</span><span class="p">:</span> <span class="n">field</span> <span class="mi">0</span> <span class="n">validity</span> <span class="n">bitmap</span>

<span class="n">buffer</span> <span class="mi">1</span><span class="p">:</span> <span class="n">field</span> <span class="mi">1</span> <span class="n">validity</span> <span class="n">bitmap</span>
<span class="n">buffer</span> <span class="mi">2</span><span class="p">:</span> <span class="n">field</span> <span class="mi">1</span> <span class="n">values</span> <span class="o">&lt;</span><span class="n">int32_t</span><span class="o">*&gt;</span>

<span class="n">buffer</span> <span class="mi">3</span><span class="p">:</span> <span class="n">field</span> <span class="mi">2</span> <span class="n">validity</span> <span class="n">bitmap</span>
<span class="n">buffer</span> <span class="mi">4</span><span class="p">:</span> <span class="n">field</span> <span class="mi">2</span> <span class="nb">list</span> <span class="n">offsets</span> <span class="o">&lt;</span><span class="n">int32_t</span><span class="o">*&gt;</span>

<span class="n">buffer</span> <span class="mi">5</span><span class="p">:</span> <span class="n">field</span> <span class="mi">3</span> <span class="n">validity</span> <span class="n">bitmap</span>
<span class="n">buffer</span> <span class="mi">6</span><span class="p">:</span> <span class="n">field</span> <span class="mi">3</span> <span class="n">values</span> <span class="o">&lt;</span><span class="n">int64_t</span><span class="o">*&gt;</span>

<span class="n">buffer</span> <span class="mi">7</span><span class="p">:</span> <span class="n">field</span> <span class="mi">4</span> <span class="n">validity</span> <span class="n">bitmap</span>
<span class="n">buffer</span> <span class="mi">8</span><span class="p">:</span> <span class="n">field</span> <span class="mi">4</span> <span class="n">values</span> <span class="o">&lt;</span><span class="n">double</span><span class="o">*&gt;</span>

<span class="n">buffer</span> <span class="mi">9</span><span class="p">:</span> <span class="n">field</span> <span class="mi">5</span> <span class="n">validity</span> <span class="n">bitmap</span>
<span class="n">buffer</span> <span class="mi">10</span><span class="p">:</span> <span class="n">field</span> <span class="mi">5</span> <span class="n">offsets</span> <span class="o">&lt;</span><span class="n">int32_t</span><span class="o">*&gt;</span>
<span class="n">buffer</span> <span class="mi">11</span><span class="p">:</span> <span class="n">field</span> <span class="mi">5</span> <span class="n">data</span> <span class="o">&lt;</span><span class="n">uint8_t</span><span class="o">*&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="logical-types">
<span id="spec-logical-types"></span><h2>Logical types<a class="headerlink" href="#logical-types" title="Permalink to this headline">¶</a></h2>
<p>A logical type consists of a type name and metadata along with an explicit
mapping to a physical memory representation. These may fall into some different
categories:</p>
<ul class="simple">
<li>Types represented as fixed-width primitive arrays (for example: C-style
integers and floating point numbers)</li>
<li>Types having equivalent memory layout to a physical nested type (e.g. strings
use the list representation, but logically are not nested types)</li>
</ul>
<div class="section" id="integers">
<h3>Integers<a class="headerlink" href="#integers" title="Permalink to this headline">¶</a></h3>
<p>In the first version of Arrow we provide the standard 8-bit through 64-bit size
standard C integer types, both signed and unsigned:</p>
<ul class="simple">
<li>Signed types: Int8, Int16, Int32, Int64</li>
<li>Unsigned types: UInt8, UInt16, UInt32, UInt64</li>
</ul>
<p>The IDL looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="n">Int</span> <span class="p">{</span>
  <span class="n">bitWidth</span><span class="p">:</span> <span class="nb">int</span><span class="p">;</span>
  <span class="n">is_signed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The integer endianness is currently set globally at the schema level. If a
schema is set to be little-endian, then all integer types occurring within must
be little-endian. Integers that are part of other data representations, such as
list offsets and union types, must have the same endianness as the entire
record batch.</p>
</div>
<div class="section" id="floating-point-numbers">
<h3>Floating point numbers<a class="headerlink" href="#floating-point-numbers" title="Permalink to this headline">¶</a></h3>
<p>We provide 3 types of floating point numbers as fixed bit-width primitive array</p>
<ul class="simple">
<li>Half precision, 16-bit width</li>
<li>Single precision, 32-bit width</li>
<li>Double precision, 64-bit width</li>
</ul>
<p>The IDL looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enum</span> <span class="n">Precision</span><span class="p">:</span><span class="nb">int</span> <span class="p">{</span><span class="n">HALF</span><span class="p">,</span> <span class="n">SINGLE</span><span class="p">,</span> <span class="n">DOUBLE</span><span class="p">}</span>

<span class="n">table</span> <span class="n">FloatingPoint</span> <span class="p">{</span>
  <span class="n">precision</span><span class="p">:</span> <span class="n">Precision</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="boolean">
<h3>Boolean<a class="headerlink" href="#boolean" title="Permalink to this headline">¶</a></h3>
<p>The Boolean logical type is represented as a 1-bit wide primitive physical
type. The bits are numbered using least-significant bit (LSB) ordering.</p>
<p>Like other fixed bit-width primitive types, boolean data appears as 2 buffers
in the data header (one bitmap for the validity vector and one for the values).</p>
</div>
<div class="section" id="list">
<h3>List<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">List</span></code> logical type is the logical (and identically-named) counterpart to
the List physical type.</p>
<p>In data header form, the list field node contains 2 buffers:</p>
<ul class="simple">
<li>Validity bitmap</li>
<li>List offsets</li>
</ul>
<p>The buffers associated with a list’s child field are handled recursively
according to the child logical type (e.g. <code class="docutils literal notranslate"><span class="pre">List&lt;Utf8&gt;</span></code> vs. <code class="docutils literal notranslate"><span class="pre">List&lt;Boolean&gt;</span></code>).</p>
</div>
<div class="section" id="utf8-and-binary">
<h3>Utf8 and Binary<a class="headerlink" href="#utf8-and-binary" title="Permalink to this headline">¶</a></h3>
<p>We specify two logical types for variable length bytes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Utf8</span></code> data is Unicode values with UTF-8 encoding</li>
<li><code class="docutils literal notranslate"><span class="pre">Binary</span></code> is any other variable length bytes</li>
</ul>
<p>These types both have the same memory layout as the nested type <code class="docutils literal notranslate"><span class="pre">List&lt;UInt8&gt;</span></code>,
with the constraint that the inner bytes can contain no null values. From a
logical type perspective they are primitive, not nested types.</p>
<p>In data header form, while <code class="docutils literal notranslate"><span class="pre">List&lt;UInt8&gt;</span></code> would appear as 2 field nodes (<code class="docutils literal notranslate"><span class="pre">List</span></code>
and <code class="docutils literal notranslate"><span class="pre">UInt8</span></code>) and 4 buffers (2 for each of the nodes, as per above), these types
have a simplified representation single field node (of <code class="docutils literal notranslate"><span class="pre">Utf8</span></code> or <code class="docutils literal notranslate"><span class="pre">Binary</span></code>
logical type, which have no children) and 3 buffers:</p>
<ul class="simple">
<li>Validity bitmap</li>
<li>List offsets</li>
<li>Byte data</li>
</ul>
</div>
<div class="section" id="decimal">
<h3>Decimal<a class="headerlink" href="#decimal" title="Permalink to this headline">¶</a></h3>
<p>Decimals are represented as a 2’s complement 128-bit (16 byte) signed integer
in little-endian byte order.</p>
</div>
<div class="section" id="timestamp">
<h3>Timestamp<a class="headerlink" href="#timestamp" title="Permalink to this headline">¶</a></h3>
<p>All timestamps are stored as a 64-bit integer, with one of four unit
resolutions: second, millisecond, microsecond, and nanosecond.</p>
</div>
<div class="section" id="date">
<h3>Date<a class="headerlink" href="#date" title="Permalink to this headline">¶</a></h3>
<p>We support two different date types:</p>
<ul class="simple">
<li>Days since the UNIX epoch as a 32-bit integer</li>
<li>Milliseconds since the UNIX epoch as a 64-bit integer</li>
</ul>
</div>
<div class="section" id="time">
<h3>Time<a class="headerlink" href="#time" title="Permalink to this headline">¶</a></h3>
<p>Time supports the same unit resolutions: second, millisecond, microsecond, and
nanosecond. We represent time as the smallest integer accommodating the
indicated unit. For second and millisecond: 32-bit, for the others 64-bit.</p>
</div>
</div>
<div class="section" id="dictionary-encoding">
<h2>Dictionary encoding<a class="headerlink" href="#dictionary-encoding" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="IPC.html" class="btn btn-neutral float-right" title="Interprocess messaging / communication (IPC)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Layout.html" class="btn btn-neutral float-left" title="Physical memory layout" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018 Apache Software Foundation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107500873-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107500873-1');
</script>


</body>
</html>